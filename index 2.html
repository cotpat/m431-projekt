<!DOCTYPE html>
<html>
<head>
	<title>Incremental Network Game</title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <h1>Black HATS</h1>

<p>Points: <span id="points"></span> Multiplier: <span id="multiplier"></span></p>


<p>
	<img src="assets/router.png" width="100", height="100">
	<img src="assets/firewall.png" width="100", height="100">  
	<img src="assets/server.png" width="100", height="100">
</p>

<p>
	Routers: <span id="routers"></span> - 
	Firewalls: <span id="firewalls"></span> - 
	Servers: <span id="servers"></span>
</p>
<!-- click button to increment points -->
<button onclick="incrementPoints()">Click for Points!</button>
<!-- display available upgrades -->
<h2>Upgrades</h2>
<ul id="upgrades">
	<!-- list of upgrades will be generated here -->
</ul>
<script>
    // initial points
    let points = 0;

    // initial counts of routers, firewalls, and servers
    let routerCount = 0;
    let firewallCount = 0;
    let serverCount = 0;

	let thousand = 0;
	let tenthousand = 0;
	let hundredthousand = 0;
	let onemillion = 0;
	let tenmillion = 0;

    // upgrade data
    let upgrades = [
    {
		name: "Faster Router",
		id: 1,
		cost: 100,
		multiplier: 2,
		count: 0,
		type: "router",
		specific_multiplier: 0
	},
	{
		name: "Additional Server",
		id: 2,
		cost: 500,
		multiplier: 5,
		count: 0,
		type: "server",
		under_type: "hardware",
		specific_multiplier: 0
	},
	{
		name: "Advanced Firewall",
		id: 3,
		cost: 1000,
		multiplier: 10,
		count: 0,
		type: "firewall",
		under_type: "hardware",
		specific_multiplier: 0
	},
	{
		name: "Optimized Network",
		id: 4,
		cost: 10000,
		multiplier: 100,
		count: 0,
		type: "router",
		under_type: "hardware",
		specific_multiplier: 0
	},
	{
		name: "Cloud Computing",
		id: 5,
		cost: 50000,
		multiplier: 500,
		count: 0,
		type: "server",
		under_type: "hardware",
		specific_multiplier: 0
	},
	{
		name: "Network Encryption",
		id: 6,
		cost: 100000,
		multiplier: 1000,
		count: 0,
		type: "firewall",
		under_type: "hardware",
		specific_multiplier: 0
	}
	,
	{
		name: "RAM upgrade for Server",
		id: 7,
		cost: 1000,
		multiplier: 0,
		count: 0,
		type: "server",
		under_type: "hardware_upgrade",
		specific_multiplier: 2
	},
	{
		name: "Switch for more ports",
		id: 8,
		cost: 1000,
		multiplier: 0,
		count: 0,
		type: "router",
		under_type: "hardware_upgrade",
		specific_multiplier: 4
	},
	{
		name: "Stronger Firewall",
		id: 9,
		cost: 1000,
		multiplier: 0,
		count: 0,
		type: "firewall",
		under_type: "hardware_upgrade",
		specific_multiplier: 6
	},
	{
		name: "Switch for more ports",
		id: 10,
		cost: 1000,
		multiplier: 0,
		count: 0,
		type: "server",
		under_type: "hardware_upgrade",
		specific_multiplier: 4
	},
	{
		name: "Quantum Computing for Network",
		id: 11,
		cost: 1000,
		multiplier: 0,
		count: 0,
		type: "firewall",
		under_type: "hardware_upgrade",
		specific_multiplier: 4
	}
];

// increment points every second
setInterval(function() {
	points += 1 * getMultiplier();
	checkAnime();
	updatePoints();
	updateCounter();
}, 1000);


// generate upgrade buttons
let upgradeList = document.getElementById("upgrades");
for (let i = 0; i < upgrades.length; i++) {
	let upgrade = upgrades[i];
	let li = document.createElement("li");
	li.innerHTML = `
		${upgrade.name}: ${upgrade.cost} points - 
		<button onclick="buyUpgrade(${i})">Buy</button>
	`;
	upgradeList.appendChild(li);
}

function checkAnime (){
	if (points >= 1000 && thousand === 0){
		document.body.className = "thousand";
		thousand = 1;
	} else if (points >= 10000 && tenthousand === 0){
		document.body.className = "tenthousand";
		tenthousand = 1;
	}
	else if (points >= 100000 && hundredthousand === 0){
		document.body.className = "hundredthousand";
		hundredthousand = 1;
	}
	else if (points >= 1000000 && onemillion === 0){
		document.body.className = "onemillion";
		onemillion = 1;
	}
	else if (points >= 10000000 && tenmillion === 0){
		document.body.className = "tenmillion";
		tenmillion = 1;
	}
}

function getUpgradeCount(type){
	let upgrade_count = 0;
	for (let i = 0; i < upgrades.length; i++) {
		let upgrade = upgrades[i];
		if (upgrade.type === type){
			upgrade_count+= upgrade.count;
		}
	}
	return upgrade_count;
}

// increment points when button is clicked
function incrementPoints() {
	points += 1 * getMultiplier();
	updatePoints();
}

// calculate total multiplier from purchased upgrades
function getMultiplier() {
	let multiplier = 1;
	for (let i = 0; i < upgrades.length; i++) {
		let upgrade = upgrades[i];
		multiplier += (upgrade.multiplier * upgrade.count);
		if (upgrade.specific_multiplier != 0 ){
			if (upgrade.count != 0){
			console.log("id:" + upgrade.id)
			let spec_mult = upgrade.specific_multiplier + (upgrade.count * getUpgradeCount(upgrade.type));
			console.log("spec mult:" + spec_mult);
			multiplier += spec_mult;
			}
		}
	}
	return multiplier;
}


// purchase an upgrade
function buyUpgrade(index) {
let upgrade = upgrades[index];
if (points >= upgrade.cost) {
points -= upgrade.cost;
upgrade.count++;
updatePoints();
updateCounter();
}
}

// update points display
function updatePoints() {
document.getElementById("points").innerHTML = points;
document.getElementById("multiplier").innerHTML = getMultiplier();
let buttons = document.getElementById("upgrades").getElementsByTagName("button");
for (let i = 0; i < buttons.length; i++) {
let button = buttons[i];
if (points >= upgrades[i].cost) {
	if(upgrades[i].under_type === "hardware_upgrade"){
		if(getUpgradeCount(upgrades[i].type) != 0){
			button.disabled = false;
		}
	} else{
		button.disabled = false;
	}
} else {
button.disabled = true;
}
}
}

// update counters for routers, firewalls, and servers
function updateCounter() {
routerCount = 0;
firewallCount = 0;
serverCount = 0;
for (let i = 0; i < upgrades.length; i++) {
let upgrade = upgrades[i];
if (upgrade.type === "router") {
routerCount += upgrade.count;
} else if (upgrade.type === "firewall") {
firewallCount += upgrade.count;
} else if (upgrade.type === "server" && upgrade.specific_multiplier === 0) {
serverCount += upgrade.count;
}
}
document.getElementById("routers").innerHTML = routerCount;
document.getElementById("firewalls").innerHTML = firewallCount;
document.getElementById("servers").innerHTML = serverCount;
}

// start game
updatePoints();
updateCounter();
</script>
</body>
</html>